jQuery(function(a){"use strict";var n={message:"",css:{border:"none",background:"transparent"},overlayCSS:{background:"#fff",opacity:.7},ignoreIfBlocked:!0},i={message:" ",css:{border:"none",background:"#fff",top:"0",left:"0",height:"100%",width:"100%",opacity:.7,cursor:"default"},overlayCSS:{opacity:0},ignoreIfBlocked:!0},t=function(e){e.each(function(){var e=a(this);e.is("input")?"checkbox"===e.attr("type")?e.removeAttr("checked"):"text"!==e.attr("type")&&"number"!==e.attr("type")||e.val(""):e.is("textarea")&&e.val("")})},o=function(e){var i=!!e.length&&{};return e.each(function(){var e,t,n;!1!==i&&(t=(e=a(this)).data("name")||!1,n=e.data("required")||"no",!t||e.is("input[type=checkbox]")&&!e.is(":checked")||(i[t]=e.val()),"yes"===n&&""===e.val()&&(e.focus(),i=!1))}),i},c=a("select#_yith_booking_duration_unit"),s=a("#_yith_booking_duration"),r={showPrefix:".bk_show_if_",enablePrefix:".bk_enable_if_",conditions:{customer_chooses_blocks:"customer_chooses_blocks",can_be_cancelled:"can_be_cancelled",customer_one_day:"customer_one_day",booking_has_persons:"booking_has_persons",day:"day",time:"time",fixed_and_time:"fixed_and_time",unit_is_month:"unit_is_month",unit_is_day:"unit_is_day",unit_is_hour:"unit_is_hour",unit_is_minute:"unit_is_minute",people_and_people_types:"people_and_people_types"},dom:{minuteSelect:a("#_yith_booking_duration_minute_select"),bookingDuration:s,bookingDurationType:a("select#_yith_booking_duration_type"),bookingDurationUnit:c,peopleEnabled:a("#_yith_booking_has_persons input"),peopleTypesEnabled:a("#_yith_booking_enable_person_types input"),productType:a("select#product-type")},initialProductType:"simple",init:function(){var i=r;i.initialProductType=i.dom.productType.val(),i.dom.minuteSelect.hide().on("change",function(){i.dom.bookingDuration.val(a(this).val())}),a(document).find("._tax_status_field").closest("div").addClass("show_if_"+wcbk_admin.prod_type),i.dom.productType.on("change",function(){r.initialProductType!==wcbk_admin.prod_type&&wcbk_admin.prod_type===a(this).val()&&a("#_virtual").attr("checked","checked").trigger("change")}).trigger("change"),i.dom.bookingDurationType.on("change",function(){i.handle(i.conditions.customer_chooses_blocks,"customer"===a(this).val())}).trigger("change"),a("#_yith_booking_can_be_cancelled input").on("change",function(){i.handle(i.conditions.can_be_cancelled,"yes"===a(this).val())}).trigger("change"),a(document).on("bk_check_if_customer_one_day",function(){var e=i.dom.bookingDurationType.val(),t=i.dom.bookingDuration.val(),n=i.dom.bookingDurationUnit.val(),n="customer"===e&&"1"===t&&"day"===n;i.handle(i.conditions.customer_one_day,n)}).trigger("bk_check_if_customer_one_day"),a(document).on("change","#_yith_booking_duration_type, #_yith_booking_duration, #_yith_booking_duration_unit",function(){a(document).trigger("bk_check_if_customer_one_day")}),a(document).on("bk_check_if_fixed_and_time",function(){var e="fixed"===i.dom.bookingDurationType.val(),t=i.dom.bookingDurationUnit.val(),t="hour"===t||"minute"===t;i.handle(i.conditions.fixed_and_time,e&&t)}).trigger("bk_check_if_fixed_and_time"),a(document).on("change","#_yith_booking_duration_type, #_yith_booking_duration_unit",function(){a(document).trigger("bk_check_if_fixed_and_time")}),i.dom.peopleEnabled.add(i.dom.peopleTypesEnabled).on("change",function(){i.handle(i.conditions.booking_has_persons,"yes"===i.dom.peopleEnabled.val()),i.handle(i.conditions.people_and_people_types,"yes"===i.dom.peopleEnabled.val()&&"yes"===i.dom.peopleTypesEnabled.val())}).trigger("change"),i.dom.bookingDurationUnit.on("change",function(){var e=a(this).val(),t="hour"===e||"minute"===e,n="day"===e;i.handle(i.conditions.time,t),i.handle(i.conditions.day,n),i.handle(i.conditions.unit_is_month,"month"===e),i.handle(i.conditions.unit_is_day,"day"===e),i.handle(i.conditions.unit_is_hour,"hour"===e),i.handle(i.conditions.unit_is_minute,"minute"===e),"minute"===e?(i.dom.bookingDuration.hide(),i.dom.minuteSelect.show().trigger("change")):(i.dom.minuteSelect.hide(),i.dom.bookingDuration.show()),a(document).trigger("yith_wcbk_booking_product_duration_unit_changed",[{value:e,has_time:t,is_day:n}])}).trigger("change")},handle:function(e,t){var n=r.enablePrefix+e,e=r.showPrefix+e;t?(a(n).unblock(),a(e).show()):(a(n).block(i),a(e).hide())}};r.init();var d=a("#yith-wcbk-booking-costs-table"),l=d.find("tr.yith-wcbk-costs-default-row").first(),e=a("#yith-wcbk-costs-add-range"),_=a("#"+d.data("fields-container-id")),u=_.find(".yith-wcbk-admin-input-range"),p=_.find(".yith-wcbk-number-range"),h=_.find(".yith-wcbk-month-range-select"),b=_.find(".yith-wcbk-week-range-select"),y=_.find(".yith-wcbk-day-range-select");d.on("change","select.yith-wcbk-costs-range-type-select",function(e){var t,n,i=a(e.target),o=i.closest("tr"),e=o.find("td.yith-wcbk-costs-from"),o=o.find("td.yith-wcbk-costs-to"),i=i.val();switch(i){case"custom":t=u.clone().addClass("yith-wcbk-admin-date-picker").yith_wcbk_datepicker(),n=u.clone().addClass("yith-wcbk-admin-date-picker").yith_wcbk_datepicker();break;case"month":t=h.clone(),n=h.clone();break;case"week":t=b.clone(),n=b.clone();break;case"day":t=y.clone(),n=y.clone();break;case"time":break;default:t=p.clone(),n=p.clone()}"time"===i?(t.find("input").attr("name","_yith_booking_costs_range[from][]"),n.find("input").attr("name","_yith_booking_costs_range[to][]")):(t.attr("name","_yith_booking_costs_range[from][]"),n.attr("name","_yith_booking_costs_range[to][]")),e.html(t),o.html(n)}).on("click",".yith-wcbk-delete",function(e){a(e.target).closest("tr").remove()}).find("tbody").sortable({items:"tr",cursor:"move",handle:".yith-wcbk-anchor",axis:"y",scrollSensitivity:40,forcePlaceholderSize:!0,opacity:.65,helper:function(e,t){var n=t.children(),t=t.clone();return t.children().each(function(e){a(this).width(n.eq(e).width())}),t}}),e.on("click",function(){var e=l.clone().removeClass("yith-wcbk-costs-default-row");d.append(e),e.find("select.yith-wcbk-costs-range-type-select").trigger("change")}),a(".yith-wcbk-google-maps-places-autocomplete").each(function(){"undefined"!=typeof google&&"undefined"!=typeof google.maps&&"undefined"!=typeof google.maps.places&&"undefined"!=typeof google.maps.places.Autocomplete?new google.maps.places.Autocomplete(this):console.error("Google Maps Javascript API error while using Autocomplete. Probably other plugins (or your theme) include Google Maps Javascript API without support to the Places library")}),a(".yith-wcbk-product-sync-imported-calendars-table").on("click",".insert",function(e){e.preventDefault();var t,n=a(e.target),i=n.data("row"),e=n.closest(".yith-wcbk-product-sync-imported-calendars-table"),n=e.find("tbody");e.data("last-index")?t=e.data("last-index")+1:(t=n.find("tr").length||0,t+=1),e.data("last-index",t),i=i.replace(new RegExp("{{INDEX}}","g"),t),n.append(a(i))}).on("click",".delete",function(e){e.preventDefault(),a(e.target).closest("tr").remove()});e=function(){var e,t=c.val(),n=s.val(),n=n<2?(e=wcbk_admin.i18n_durations[t].singular.replace("%s",n),wcbk_admin.i18n_durations[t].singular_qty.replace("%s",n)):(e=wcbk_admin.i18n_durations[t].plural.replace("%s",n),wcbk_admin.i18n_durations[t].plural_qty.replace("%s",n)),t=wcbk_admin.i18n_durations[t].plural_unit;a(".yith-wcbk-product-metabox-dynamic-duration").html(e),a(".yith-wcbk-product-metabox-dynamic-duration-qty").html(n),a(".yith-wcbk-product-metabox-dynamic-duration-unit").html(t)};a(document).on("change","#_yith_booking_duration, #_yith_booking_duration_unit",e),a(document).on("yith_wcbk_product_metabox_dynamic_durations",e),e();var g={container:a("#yith-wcbk-people-types__create"),list:a("#yith-wcbk-people-types__list"),fields:a("#yith-wcbk-people-types__create .yith-wcbk-fake-form-field"),init:function(){var e=g;e.container.on("keydown",e.prevent_submit_on_enter).on("click",".yith-wcbk-people-types__create-submit",e.create).hide(),a("#yith-wcbk-people-types__create-btn").on("click",e.toggle)},close:function(){g.container.slideUp(200)},toggle:function(){g.container.slideToggle(200)},prevent_submit_on_enter:function(e){if(13===e.keyCode)return e.preventDefault(),!1},reset_form:function(){var e=g.fields;t(e)},get_form_data:function(){var e=g.fields;return o(e)},create:function(){var e=g.container,t=g.get_form_data();t&&(t.action="yith_wcbk_create_people_type",e.block(n),a.ajax({type:"POST",data:t,url:ajaxurl,success:function(e){e.message&&alert(e.message),e.id&&e.title&&(g.add_row(e.id,e.title),g.reset_form(),g.close())},complete:function(){e.unblock()}}))},add_row:function(e,t){var n=wp.template("yith-wcbk-people-type-row");g.list.append(a(n({id:e,title:t})))}};g.init();var k={container:a("#yith-wcbk-services__create"),fields:a("#yith-wcbk-services__create .yith-wcbk-fake-form-field"),services:a("#_yith_wcbk_booking_services"),init:function(){var e=k;e.container.on("keydown",e.prevent_submit_on_enter).on("click",".yith-wcbk-services__create-submit",e.create).hide(),a("#yith-wcbk-services__create-btn").on("click",e.toggle)},close:function(){k.container.slideUp(400)},toggle:function(){k.container.slideToggle(400)},prevent_submit_on_enter:function(e){if(13===e.keyCode)return e.preventDefault(),!1},reset_form:function(){var e=k.fields;t(e)},get_form_data:function(){var e=k.fields;return o(e)},create:function(){var e=k.container,t=k.get_form_data();t&&(t.action="yith_wcbk_create_service",e.block(n),a.ajax({type:"POST",data:t,url:ajaxurl,success:function(e){var t;e.message&&alert(e.message),e.id&&e.title&&(t=a('<option value="'+e.id+'" selected="selected">'+e.title+"</option>"),k.services.append(t),k.services.removeClass("enhanced"),a(document.body).trigger("wc-enhanced-select-init"),k.services.focus(),k.reset_form(),k.close()),e.debug&&console.log(e.debug)},complete:function(){e.unblock()}}))}};k.init();var m={list:a("#yith-wcbk-extra-costs__list"),customExtraCosts:!1,lastIndex:1,init:function(){this._initParams(),a("#yith-wcbk-extra-costs__new-extra-cost").on("click",this.addExtraCost),a(document).on("click",".yith-wcbk-extra-cost__delete",this.deleteExtraCost)},_initParams:function(){this.customExtraCosts=this.list.find(".yith-wcbk-extra-cost--custom"),this.lastIndex=this.customExtraCosts.length||0},nextIndex:function(){return++this.lastIndex},addExtraCost:function(e){e.preventDefault();var t=a(e.target).data("template"),e=m.nextIndex(),t=t.replace(new RegExp("{{INDEX}}","g"),e),t=a(t);m.list.append(t),t.find(".yith-wcbk-extra-cost__name").first().focus()},deleteExtraCost:function(e){a(e.target).closest(".yith-wcbk-extra-cost").remove()}};m.init();var f={expandCollapseButton:a(".yith-wcbk-people-types__expand-collapse"),list:a("#yith-wcbk-people-types__list"),init:function(){this.expandCollapseButton.on("click",this.expandCollapseAll)},expandCollapseAll:function(e){var t=a(e.target).closest(".yith-wcbk-people-types__expand-collapse"),e=f.list;t.is(".yith-wcbk-people-types__expand-collapse--collapse")?(t.removeClass("yith-wcbk-people-types__expand-collapse--collapse"),e.find(".yith-wcbk-settings-section-box:not(.yith-wcbk-settings-section-box--closed) .yith-wcbk-settings-section-box__toggle").click()):(t.addClass("yith-wcbk-people-types__expand-collapse--collapse"),e.find(".yith-wcbk-settings-section-box.yith-wcbk-settings-section-box--closed .yith-wcbk-settings-section-box__toggle").click())}};f.init()});